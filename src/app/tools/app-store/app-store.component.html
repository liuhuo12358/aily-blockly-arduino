@if (currentUrl == "/code-viewer") {
<app-sub-window [title]="windowInfo | translate" [winBtns]="['go-main', 'minimize', 'maximize', 'close']">
    <ng-container *ngTemplateOutlet="windowBoxTemplate"></ng-container>
</app-sub-window>
} @else {
<app-tool-container [title]="windowInfo | translate" (closeEvent)="close()">
    <ng-container *ngTemplateOutlet="windowBoxTemplate"></ng-container>
</app-tool-container>
}
<ng-template #windowBoxTemplate>
    <div class="app-store-container">
        <div class="app-store-header">
            <div class="header-info">
                <span class="info-text">{{ 'APP_STORE.HEADER_INFO' | translate:{count: headerAppLimit} }}</span>
            </div>
            <button class="reset-btn" (click)="resetToDefault()">
                <i class="fa-light fa-rotate-left"></i>
                {{ 'APP_STORE.RESET' | translate }}
            </button>
        </div>
        
        <!-- Header 区域：前6个 -->
        <div class="section-title">
            <i class="fa-light fa-grip"></i>
            {{ 'APP_STORE.TOOLBAR_APPS' | translate }}
        </div>
        <div class="app-grid header-zone" cdkDropList #headerList="cdkDropList" [cdkDropListData]="headerZoneApps"
            [cdkDropListConnectedTo]="[otherList]" (cdkDropListDropped)="drop($event)">
            @for (app of headerZoneApps; track app.id; let i = $index) {
            <div class="app-card" cdkDrag [class.dev]="app.dev" (dblclick)="openApp(app)">
                <div class="card-drag-placeholder" *cdkDragPlaceholder></div>
                <div class="app-icon">
                    <i class="{{ app.icon }}"></i>
                    @if (app.more) {
                    <span class="app-badge">{{ app.more }}</span>
                    }
                </div>
                <div class="app-name">
                    {{ app.name | translate }}
                    @if (app.dev) {
                    <span class="dev-tag">DEV</span>
                    }
                </div>
                <div class="header-indicator">
                    <i class="fa-solid fa-circle-check"></i>
                </div>
            </div>
            }
            @for (i of emptySlots; track i) {
            <div class="app-card empty-slot">
                <div class="empty-icon">
                    <i class="fa-light fa-plus"></i>
                </div>
                <div class="empty-text">{{ 'APP_STORE.DRAG_HERE' | translate }}</div>
            </div>
            }
        </div>

        <!-- 其他应用区域 -->
        <div class="section-title">
            <i class="fa-light fa-grid-2"></i>
            {{ 'APP_STORE.OTHER_APPS' | translate }}
        </div>
        <div class="app-grid other-zone" cdkDropList #otherList="cdkDropList" [cdkDropListData]="otherZoneApps"
            [cdkDropListConnectedTo]="[headerList]" (cdkDropListDropped)="drop($event)">
            @for (app of otherZoneApps; track app.id) {
            <div class="app-card" cdkDrag [class.dev]="app.dev" (dblclick)="openApp(app)">
                <div class="card-drag-placeholder" *cdkDragPlaceholder></div>
                <div class="app-icon">
                    <i class="{{ app.icon }}"></i>
                    @if (app.more) {
                    <span class="app-badge">{{ app.more }}</span>
                    }
                </div>
                <div class="app-name">
                    {{ app.name | translate }}
                    @if (app.dev) {
                    <span class="dev-tag">DEV</span>
                    }
                </div>
            </div>
            }
        </div>
    </div>
</ng-template>